<!DOCTYPE html>
<html>
<head>
    <title>Storefront Pricing Check</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test { margin: 20px 0; padding: 15px; background: #2a2a2a; border-radius: 8px; }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        pre { background: #000; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üß™ Storefront Pricing Diagnostic</h1>
    
    <div class="test">
        <h2>Test 1: API Response</h2>
        <button onclick="testAPI()">Check API</button>
        <pre id="api-result">Click button to test...</pre>
    </div>
    
    <div class="test">
        <h2>Test 2: Storefront Page</h2>
        <button onclick="testStorefront()">Check Storefront</button>
        <pre id="storefront-result">Click button to test...</pre>
    </div>
    
    <div class="test">
        <h2>Test 3: Browser Console</h2>
        <p>Open browser console (F12) and look for:</p>
        <ul>
            <li>üõçÔ∏è Storefront Shop - Products: XXX</li>
            <li>üõçÔ∏è Storefront Shop - Products with pricing: XXX</li>
            <li>üõí Shop Client - Products: XXX</li>
            <li>Product XXX has X pricing tiers</li>
        </ul>
    </div>

    <script>
        async function testAPI() {
            const result = document.getElementById('api-result');
            result.textContent = 'Loading...';
            
            try {
                const response = await fetch('/api/page-data/products');
                const data = await response.json();
                
                const floraProducts = data.data.products.filter(p => 
                    p.vendor_id === 'cd2e1122-d511-4edb-be5d-98ef274b4baf'
                );
                
                const withPricing = floraProducts.filter(p => 
                    p.pricing_tiers && p.pricing_tiers.length > 0
                );
                
                const sample = floraProducts[0];
                
                result.innerHTML = `<span class="success">‚úÖ API Working!</span>

Total Products: ${data.data.products.length}
Flora Distro Products: ${floraProducts.length}
Products with pricing: ${withPricing.length}

Sample Product:
  Name: ${sample.name}
  Pricing Tiers: ${sample.pricing_tiers?.length || 0}
  
${sample.pricing_tiers ? 
  sample.pricing_tiers.map(t => `  ‚Ä¢ ${t.label}: $${t.price}`).join('\n') 
  : '  No pricing tiers'}`;
            } catch (error) {
                result.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
            }
        }
        
        async function testStorefront() {
            const result = document.getElementById('storefront-result');
            result.textContent = 'Loading...';
            
            try {
                const response = await fetch('/test-storefront/shop');
                const html = await response.text();
                
                // Check if page has product cards
                const hasProducts = html.includes('grid grid-cols');
                const hasPricingSelector = html.includes('Select Quantity');
                
                result.innerHTML = `<span class="${hasProducts ? 'success' : 'error'}">${hasProducts ? '‚úÖ' : '‚ùå'} Products: ${hasProducts ? 'Found' : 'Not found'}</span>
<span class="${hasPricingSelector ? 'success' : 'error'}">${hasPricingSelector ? '‚úÖ' : '‚ùå'} Pricing Selector: ${hasPricingSelector ? 'Found' : 'Not found'}</span>

Page Size: ${(html.length / 1024).toFixed(2)} KB
Contains "pricingTiers": ${html.includes('pricingTiers') ? 'Yes' : 'No'}

Action Required:
1. Open http://localhost:3000/test-storefront/shop in browser
2. Open DevTools Console (F12)
3. Look for console logs showing pricing data
4. Hard refresh (Cmd+Shift+R / Ctrl+Shift+F5)`;
            } catch (error) {
                result.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>

