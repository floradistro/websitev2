/**
 * iOS PWA Safe Area Fix - SIMPLE & EFFECTIVE
 *
 * Problem: Content goes behind iOS status bar and large gap at bottom
 * Solution: Add padding using env() safe area insets
 *
 * IMPORTANT: This CSS only applies when:
 * 1. Running on iOS (detected via -webkit-touch-callout)
 * 2. Running in standalone mode (installed PWA)
 */

/* iOS PWA Detection */
@supports (-webkit-touch-callout: none) {
  @media (display-mode: standalone) {
    /* Add safe area padding to body - NO position changes */
    body {
      padding-top: env(safe-area-inset-top) !important;
      padding-bottom: env(safe-area-inset-bottom) !important;
      padding-left: env(safe-area-inset-left) !important;
      padding-right: env(safe-area-inset-right) !important;

      /* Prevent iOS rubber band scrolling */
      overscroll-behavior: none;
      -webkit-overflow-scrolling: touch;

      /* Ensure body takes full height */
      min-height: 100dvh;
    }

    /* Adjust #__next to account for safe area padding */
    #__next {
      min-height: calc(
        100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom)
      );
    }

    /* Prevent zoom on input focus */
    input,
    textarea,
    select {
      font-size: 16px !important;
    }

    /* Landscape mode - extra padding for notch on sides */
    @media (orientation: landscape) {
      body {
        padding-left: max(env(safe-area-inset-left), 40px) !important;
        padding-right: max(env(safe-area-inset-right), 40px) !important;
      }
    }
  }
}

/* Debug mode - add class="debug-safe-areas" to body to visualize */
@supports (-webkit-touch-callout: none) {
  @media (display-mode: standalone) {
    body.debug-safe-areas::before {
      content: "Status Bar Safe Area: " attr(data-top);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: env(safe-area-inset-top);
      background: rgba(255, 0, 0, 0.5);
      z-index: 999999;
      pointer-events: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: white;
      font-weight: bold;
    }

    body.debug-safe-areas::after {
      content: "Home Indicator Safe Area";
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: env(safe-area-inset-bottom);
      background: rgba(0, 255, 0, 0.5);
      z-index: 999999;
      pointer-events: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: white;
      font-weight: bold;
    }
  }
}
